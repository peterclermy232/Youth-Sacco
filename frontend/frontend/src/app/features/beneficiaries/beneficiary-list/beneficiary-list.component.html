<div class="beneficiary-container">
  <!-- Header -->
  <div class="page-header" @fadeInUp>
    <div>
      <h1>Beneficiaries</h1>
      <p>Manage your beneficiary information and documents</p>
    </div>
    <button mat-raised-button color="primary" (click)="navigateToAdd()">
      <mat-icon>person_add</mat-icon>
      Add Beneficiary
    </button>
  </div>

  <!-- Loading State -->
  <app-loading-spinner *ngIf="loading" message="Loading beneficiaries..."></app-loading-spinner>

  <!-- Content -->
  <div *ngIf="!loading">
    <!-- Info Banner -->
    <div class="info-banner" @fadeInUp>
      <mat-icon class="info-icon">info</mat-icon>
      <div>
        <h4>Important Notice</h4>
        <p>Birth certificates are mandatory for all child beneficiaries. Please ensure all documents are up to date.</p>
      </div>
    </div>

    <!-- Beneficiaries Grid -->
    <div class="beneficiaries-grid" *ngIf="beneficiaries.length > 0" @staggerIn>
      <mat-card *ngFor="let beneficiary of beneficiaries"
                class="beneficiary-card"
                [class.primary-card]="beneficiary.is_primary">

        <span *ngIf="beneficiary.is_primary" class="primary-badge">Primary</span>

        <div class="card-header">
          <div class="avatar">{{ getInitials(beneficiary.full_name) }}</div>
          <div class="header-info">
            <h3>{{ beneficiary.full_name }}</h3>
            <p>{{ beneficiary.relationship }}</p>
          </div>
        </div>

        <div class="card-details">
          <div class="detail-row">
            <span class="label">Age:</span>
            <span class="value">{{ beneficiary.date_of_birth ? calculateAge(beneficiary.date_of_birth) : 'N/A' }} years</span>
          </div>
          <div class="detail-row">
            <span class="label">Profession:</span>
            <span class="value">{{ beneficiary.occupation || 'N/A' }}</span>
          </div>
          <div class="detail-row">
            <mat-icon class="detail-icon">phone</mat-icon>
            <span class="value">{{ beneficiary.phone_number }}</span>
          </div>
          <div class="detail-row">
            <span class="label">Share:</span>
            <span class="value share-value">{{ beneficiary.percentage_share }}%</span>
          </div>
        </div>

        <div class="card-footer">
          <span [class]="'status-badge ' + getStatusClass(beneficiary.status)">
            <mat-icon *ngIf="beneficiary.status === 'ACTIVE'">check_circle</mat-icon>
            {{ getStatusLabel(beneficiary.status) }}
          </span>

          <div class="actions">
            <button mat-icon-button (click)="navigateToEdit(beneficiary.id!)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteBeneficiary(beneficiary.id!, beneficiary.full_name)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </div>
      </mat-card>

      <!-- Add New Card -->
      <div class="add-card" (click)="navigateToAdd()">
        <div class="add-icon">
          <mat-icon>person_add</mat-icon>
        </div>
        <div class="add-content">
          <h3>Add Beneficiary</h3>
          <p>Add a new beneficiary to your account</p>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="beneficiaries.length === 0" class="empty-state" @fadeInUp>
      <mat-icon>group</mat-icon>
      <h3>No beneficiaries yet</h3>
      <p>Add beneficiaries to ensure your contributions are distributed according to your wishes</p>
      <button mat-raised-button color="primary" (click)="navigateToAdd()">
        <mat-icon>add</mat-icon>
        Add First Beneficiary
      </button>
    </div>

    <!-- Document Requirements -->
    <mat-card class="requirements-card" *ngIf="beneficiaries.length > 0" @fadeInUp>
      <h3>Required Documents</h3>

      <div class="requirements-grid">
        <div class="requirement-item">
          <mat-icon class="req-icon primary">description</mat-icon>
          <div>
            <h4>Identity Document</h4>
            <p>National ID or Passport for adult beneficiaries</p>
          </div>
        </div>

        <div class="requirement-item">
          <mat-icon class="req-icon accent">description</mat-icon>
          <div>
            <h4>Birth Certificate</h4>
            <p>Mandatory for all child beneficiaries</p>
          </div>
        </div>

        <div class="requirement-item">
          <mat-icon class="req-icon muted">description</mat-icon>
          <div>
            <h4>Supporting Document</h4>
            <p>Optional additional documentation</p>
          </div>
        </div>
      </div>
    </mat-card>
  </div>
</div>
